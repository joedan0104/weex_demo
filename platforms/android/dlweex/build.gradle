apply plugin: 'maven'
apply plugin: 'com.android.library'

def config = rootProject.ext// android基本配置
android {
    compileSdkVersion config.android.compileSdkVersion
    buildToolsVersion config.android.buildToolsVersion

    defaultConfig {
        minSdkVersion config.android.minSdkVersion
        targetSdkVersion config.android.targetSdkVersion
        versionCode config.android.versionCode
        versionName config.android.versionName
        // lint error
        lintOptions.abortOnError false
    }

    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }
    }

}

dependencies {
    compile fileTree(include: ['*.jar'], dir: 'libs')
    compile config.dependencies['support-v4']
    compile config.dependencies['appcompat-v7']
    compile config.dependencies['design']
    compile config.dependencies['support-annotations']
    compile 'com.google.code.findbugs:jsr305:2.0.1'
    compile 'com.squareup.okhttp:okhttp:2.3.0'
    compile 'com.squareup.okhttp:okhttp-ws:2.3.0'
    compile 'com.squareup.okio:okio:1.0.1'
    compile 'com.squareup.picasso:picasso:2.5.2'
    compile 'com.journeyapps:zxing-android-embedded:3.4.0'
    compile config.dependencies['fastjson']
    compile 'com.taobao.android:weex_inspector:0.10.0.5'
    compile 'com.taobao.android:weex_sdk:0.16.0'
    // PLUGIN GRADLE EXTENSIONS START
    compile 'com.taobao.android:weexplugin-loader:1.3'
    compile 'com.taobao.android:weexplugin-processor:1.3'
    compile 'com.taobao.android:weexplugin-annotation:1.3'
    // PLUGIN GRADLE EXTENSIONS END
}

uploadArchives {
    repositories.mavenDeployer {

        def mavenConstant = config.maven_lib_dlweex
        def mavenPublic = config.maven_public// maven公共参数

        pom.project {
            version mavenConstant["version"]
            artifactId mavenConstant["artifactId"]
            groupId mavenPublic["groupId"]
            packaging mavenPublic["type"]
            description mavenConstant["description"]
        }

        def isSnapshot = pom.version.endsWith('-SNAPSHOT')// 是否为snapshot包
        def userName = mavenPublic["userName"]
        def passWord = mavenPublic["passWord"]

        if (isSnapshot) {// snapshot
            snapshotRepository(url: mavenPublic["snapShotUrl"]) {
                authentication(userName: userName, password: passWord)
            }
        } else {// release
            repository(url: mavenPublic["releaseUrl"]) {
                authentication(userName: userName, password: passWord)
            }
        }
    }
}
